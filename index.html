<!DOCTYPE html>
<html lang="es">
<cabeza>
    <meta conjunto de caracteres="UTF-8">
    <meta name="viewport" content="ancho=ancho-del-dispositivo, escala-inicial=1.0">
    <title>REGISTRO DE PEDIDOS ACTECK</title>
    <estilo>
        cuerpo {
            familia de fuentes: Arial, sans-serif;
            color de fondo: #000;
            color blanco;
            alinear texto: centro;
            relleno: 20px;
            text-transform: mayúsculas;
        }
        h1 {
            margen inferior: 20px;
        }
        .opciones {
            pantalla:flexible;
            justificar-contenido: centro;
            espacio: 20px;
            margen inferior: 20px;
        }
        .registro-formulario {
            pantalla: ninguna;
            ancho máximo: 600px;
            margen: 0 automático;
            alinear texto: izquierda;
            relleno: 20px;
            borde: 1px sólido #555;
            color de fondo: #222;
        }
        .registro-form.activo {
            bloqueo de pantalla;
        }
        etiqueta {
            bloqueo de pantalla;
            margen inferior: 5px;
            color blanco;
        }
        entrada, área de texto, seleccionar {
            ancho: 100%;
            relleno: 5px;
            margen inferior: 10px;
            color de fondo: #333;
            color blanco;
            borde: ninguno;
        }
        botón {
            relleno: 8px 20px;
            color de fondo: #4CAF50;
            color blanco;
            borde: ninguno;
            cursor: puntero;
            margen superior: 10px;
            text-transform: mayúsculas;
        }
        botón.cancelar {
            color de fondo: #f44336;
        }
        botón:hover {
            color de fondo: #45a049;
        }
        .mensaje {
            color: #4CAF50;
            margen superior: 10px;
        }
        .registros {
            ancho máximo: 600px;
            margen: 20px automático;
            alinear texto: izquierda;
            relleno: 20px;
            borde: 1px sólido #555;
            color de fondo: #333;
            pantalla: ninguna;
        }
        .registros.activo {
            bloqueo de pantalla;
        }
        .registro {
            margen inferior: 10px;
            relleno: 10px;
            borde: 1px sólido #555;
        }
        .registro.entrega {
            color de fondo: azul; /* Color azul para registros de entrega */
        }
        .registro.finalizado {
            color de fondo: verde; /* Color verde para registros finalizados */
        }
        #reloj-contenedor {
            pantalla:flexible;
            justificar-contenido: espacio-entre;
            alinear-elementos: centro;
            margen inferior: 20px;
        }
        #reloj {
            tamaño de fuente: 20px;
        }
        #exportar-contenedor {
            pantalla:flexible;
            flex-direccion: columna;
            alinear-elementos: centro;
        }
        #exportar-contenedor etiqueta {
            margen inferior: 5px;
        }
    </estilo>
</cabeza>
<cuerpo>
    <div id="contenedor-de-reloj">
        <div id="exportar-contenedor">
            <label for="fechaInicio">Fecha de inicio:</label>
            <input type="date" id="fechaInicio">
            <label for="fechaFin">Fecha de Fin:</label>
            <input type="fecha" id="fechaFin">
            <button onclick="exportarRegistros()">Exportar Registros</button>
        </div>
        <div id="reloj"></div>
    </div>
    <h1>REGISTRO DE PEDIDOS ACTECK</h1>

    <div class="opciones">
        <button onclick="mostrarFormulario('entrega')">SURTIDO</button>
        <button onclick="mostrarFormulario('finalizado')">EMPAQUE</button>
    </div>

    <div id="registroEntrega" class="registro-form">
        <h2>Registro de entrega de pedidos a paquete</h2>
        <form id="formEntrega">
            <label for="nombreEntrega">Usuario:</label>
            <input type="text" id="nombreEntrega" requerido>
            <br>
            <label for="pedidoEntrega">GDL:</label>
            <input type="text" id="pedidoEntrega" requerido>
            <br>
            <button type="button" onclick="registrarEntrega()">Registrador Entrega</button>
            <button type="button" class="cancelar" onclick="cancelarRegistro('entrega')">Cancelar</button>
        </formulario>
        <p id="mensajeEntrega" class="message"></p>
    </div>

    <div id="registroFinalizado" class="registro-form">
        <h2>Registro de finalización de empaque de pedidos</h2>
        <form id="formularioFinalizado">
            <label for="nombreFinalizado">Usuario:</label>
            <input type="text" id="nombreFinalizado" requerido>
            <br>
            <label for="pedidoFinalizado">GDL:</label>
            <input type="text" id="pedidoFinalizado" requerido>
            <br>
            <label for="estatus">Estado:</label>
            <select id="estado" requerido>
                <option value="completo">Completo</option>
                <option value="incidencia">Incidencia</option>
            </seleccionar>
            <br>
            <textarea id="observaciones" placeholder="Observaciones (si se aplica)"></textarea>
            <br>
            <button type="button" onclick="registrarFinalizado()">Finalizar</button>
            <button type="button" class="cancelar" onclick="cancelarRegistro('finalizado')">Cancelar</button>
        </formulario>
        <p id="mensajeFinalizado" class="message"></p>
    </div>

    <div id="registros" class="registros">
        <h2>Registros Realizados</h2>
        <div id="listaRegistros"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <guión>
        función mostrarFormulario(opcion) {
            documento.getElementById('registroEntrega').classList.remove('activo');
            document.getElementById('registroFinalizado').classList.remove('activo');
            documento.getElementById('registros').classList.remove('activo');

            si (opcion === 'entrega') {
                documento.getElementById('registroEntrega').classList.add('activo');
            } else if (opcion === 'finalizado') {
                document.getElementById('registroFinalizado').classList.add('activo');
            }
        }

        función registrarEntrega() {
            const nombre = document.getElementById('nombreEntrega').value;
            const pedido = document.getElementById('pedidoEntrega').value;
            constante timestamp = nueva Fecha().toLocaleString();

            const registro = {
                nombre: nombre,
                pedido: pedido,
                fecha: marca de tiempo
            };

            // Simulación de almacenamiento local (no persistente)
            deje que registros = JSON.parse(localStorage.getItem('entrega')) || [];
            registros.push(registro);
            localStorage.setItem('entrega', JSON.stringify(registros));

            documento.getElementById('formEntrega').reset();
            document.getElementById('mensajeEntrega').innerText = 'El registro se realizó exitosamente.';
            mostrarRegistros();
            establecerTiempo de espera(() => {
                document.getElementById('mensajeEntrega').innerText = '';
                documento.getElementById('registroEntrega').classList.remove('activo');
            }, 3000);
        }

        función registrarFinalizado() {
            const nombre = document.getElementById('nombreFinalizado').value;
            const pedido = document.getElementById('pedidoFinalizado').value;
            const estatus = document.getElementById('estado').value;
            const observaciones = document.getElementById('observaciones').value;
            constante timestamp = nueva Fecha().toLocaleString();

            const registro = {
                nombre: nombre,
                pedido: pedido,
                fecha: marca de tiempo,
                estatus: estatus,
                Observaciones: observaciones
            };

            // Simulación de almacenamiento local (no persistente)
            dejar registros = JSON.parse(localStorage.getItem('finalizado')) || [];
            registros.push(registro);
            localStorage.setItem('finalizado', JSON.stringify(registros));

            documento.getElementById('formularioFinalizado').reset();
            document.getElementById('mensajeFinalizado').innerText = 'El registro se realizó exitosamente.';
            mostrarRegistros();
            establecerTiempo de espera(() => {
                document.getElementById('mensajeFinalizado').innerText = '';
                document.getElementById('registroFinalizado').classList.remove('activo');
            }, 3000);
        }

        función cancelarRegistro(opcion) {
            si (opcion === 'entrega') {
                documento.getElementById('registroEntrega').classList.remove('activo');
            } else if (opcion === 'finalizado') {
                document.getElementById('registroFinalizado').classList.remove('activo');
            }
        }

        función mostrarRegistros() {
            deja entregaRegistros = JSON.parse(localStorage.getItem('entrega')) || [];
            deje que finalizadoRegistros = JSON.parse(localStorage.getItem('finalizado')) || [];

            deje listaHTML = '';
            entregaRegistros.forEach(registro => {
                listaHTML += `<div class="registro entrega">
                                <p><strong>Nombre:</strong> ${registro.nombre}</p>
                                <p><strong>GDL:</strong> ${registro.pedido}</p>
                                <p><strong>Fecha:</strong> ${registro.fecha}</p>
                             </div>`;
            });

            finalizadoRegistros.forEach(registro => {
                listaHTML += `<div class="registro finalizado">
                                <p><strong>Nombre:</strong> ${registro.nombre}</p>
                                <p><strong>GDL:</strong> ${registro.pedido}</p>
                                <p><strong>Fecha:</strong> ${registro.fecha}</p>
                                <p><strong>Estado:</strong> ${registro.estatus}</p>
                                <p><strong>Observaciones:</strong> ${registro.observaciones}</p>
                             </div>`;
            });

            documento.getElementById('listaRegistros').innerHTML = listaHTML;
            documento.getElementById('registros').classList.add('activo');
        }

        función actualizarReloj() {
            const ahora = nueva Fecha();
            const horas = String(now.getHours()).padStart(2, '0');
            const minutos = String(now.getMinutes()).padStart(2, '0');
            const segundos = String(now.getSeconds()).padStart(2, '0');
            const tiempo = `${horas}:${minutos}:${segundos}`;
            document.getElementById('reloj').innerText = tiempo;
        }

        función exportarRegistros() {
            deja entregaRegistros = JSON.parse(localStorage.getItem('entrega')) || [];
            deje que finalizadoRegistros = JSON.parse(localStorage.getItem('finalizado')) || [];

            const fechaInicio = new Date(document.getElementById('fechaInicio').value);
            const fechaFin = new Date(document.getElementById('fechaFin').value);

            entregaRegistros = entregaRegistros.filter(registro => {
                const fechaRegistro = new Date(registro.fecha);
                devolver fechaRegistro >= fechaInicio && fechaRegistro <= fechaFin;
            });

            finalizadoRegistros = finalizadoRegistros.filter(registro => {
                const fechaRegistro = new Date(registro.fecha);
                devolver fechaRegistro >= fechaInicio && fechaRegistro <= fechaFin;
            });

            deja que entregaData = entregaRegistros.map(registro => ({
                Nombre: registro.nombre,
                'GDL': registro.pedido,
                Fecha: registro.fecha
            }));

            deje que finalizadoData = finalizadoRegistros.map(registro => ({
                Nombre: registro.nombre,
                'GDL': registro.pedido,
                Fecha: registro.fecha,
                Estado: registro.estado,
                Observaciones: registro.observaciones
            }));

            sea ​​wb = XLSX.utils.book_new();

            deje que wsEntrega = XLSX.utils.json_to_sheet(entregaData);
            XLSX.utils.book_append_sheet(wb, wsEntrega, 'Registros de Entrega');

            dejar wsFinalizado = XLSX.utils.json_to_sheet(finalizadoData);
            XLSX.utils.book_append_sheet(wb, wsFinalizado, 'Registros de Finalizado');

            XLSX.writeFile(wb, 'registros.xlsx');
        }

        // Mostrar registros al cargar la página
        ventana.onload = función() {
            mostrarRegistros();
            setInterval(actualizarReloj, 1000);
        };
    </script>
</cuerpo>
</html>