<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REGISTRO DE PEDIDOS ACTECK</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: white;
            text-align: center;
            padding: 20px;
            text-transform: uppercase;
        }
        h1 {
            margin-bottom: 20px;
        }
        .opciones {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        .registro-form {
            display: none;
            max-width: 600px;
            margin: 0 auto;
            text-align: left;
            padding: 20px;
            border: 1px solid #555;
            background-color: #222;
        }
        .registro-form.active {
            display: block;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: white;
        }
        input, textarea, select {
            width: 100%;
            padding: 5px;
            margin-bottom: 10px;
            background-color: #333;
            color: white;
            border: none;
        }
        button {
            padding: 8px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 10px;
            text-transform: uppercase;
        }
        button.cancelar {
            background-color: #f44336;
        }
        button:hover {
            background-color: #45a049;
        }
        .message {
            color: #4CAF50;
            margin-top: 10px;
        }
        .registros {
            max-width: 600px;
            margin: 20px auto;
            text-align: left;
            padding: 20px;
            border: 1px solid #555;
            background-color: #333;
            display: none;
        }
        .registros.active {
            display: block;
        }
        .registro {
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #555;
        }
        .registro.entrega {
            background-color: blue; /* Color azul para registros de entrega */
        }
        .registro.finalizado {
            background-color: green; /* Color verde para registros finalizados */
        }
        #reloj-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        #reloj {
            font-size: 20px;
        }
        #exportar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #exportar-container label {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div id="reloj-container">
        <div id="exportar-container">
            <label for="fechaInicio">Fecha de Inicio:</label>
            <input type="date" id="fechaInicio">
            <label for="fechaFin">Fecha de Fin:</label>
            <input type="date" id="fechaFin">
            <button onclick="exportarRegistros()">Exportar Registros</button>
        </div>
        <div id="reloj"></div>
    </div>
    <h1>REGISTRO DE PEDIDOS ACTECK</h1>

    <div class="opciones">
        <button onclick="mostrarFormulario('entrega')">SURTIDO</button>
        <button onclick="mostrarFormulario('finalizado')">EMPAQUE</button>
    </div>

    <div id="registroEntrega" class="registro-form">
        <h2>Registro de entrega de pedidos a empaque</h2>
        <form id="formEntrega">
            <label for="nombreEntrega">Nombre del Registrador:</label>
            <input type="text" id="nombreEntrega" required>
            <br>
            <label for="pedidoEntrega">Número de Pedido:</label>
            <input type="text" id="pedidoEntrega" required>
            <br>
            <button type="button" onclick="registrarEntrega()">Registrar Entrega</button>
            <button type="button" class="cancelar" onclick="cancelarRegistro('entrega')">Cancelar</button>
        </form>
        <p id="mensajeEntrega" class="message"></p>
    </div>

    <div id="registroFinalizado" class="registro-form">
        <h2>Registro de finalizado de empaque de pedidos</h2>
        <form id="formFinalizado">
            <label for="nombreFinalizado">Nombre del Registrador:</label>
            <input type="text" id="nombreFinalizado" required>
            <br>
            <label for="pedidoFinalizado">Número de Pedido:</label>
            <input type="text" id="pedidoFinalizado" required>
            <br>
            <label for="estatus">Estatus:</label>
            <select id="estatus" required>
                <option value="completo">Completo</option>
                <option value="incidencia">Incidencia</option>
            </select>
            <br>
            <textarea id="observaciones" placeholder="Observaciones (si aplica)"></textarea>
            <br>
            <button type="button" onclick="registrarFinalizado()">Finalizar</button>
            <button type="button" class="cancelar" onclick="cancelarRegistro('finalizado')">Cancelar</button>
        </form>
        <p id="mensajeFinalizado" class="message"></p>
    </div>

    <div id="registros" class="registros">
        <h2>Registros Realizados</h2>
        <div id="listaRegistros"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <script>
        function mostrarFormulario(opcion) {
            document.getElementById('registroEntrega').classList.remove('active');
            document.getElementById('registroFinalizado').classList.remove('active');
            document.getElementById('registros').classList.remove('active');

            if (opcion === 'entrega') {
                document.getElementById('registroEntrega').classList.add('active');
            } else if (opcion === 'finalizado') {
                document.getElementById('registroFinalizado').classList.add('active');
            }
        }

        function registrarEntrega() {
            const nombre = document.getElementById('nombreEntrega').value;
            const pedido = document.getElementById('pedidoEntrega').value;
            const timestamp = new Date().toLocaleString();

            const registro = {
                nombre: nombre,
                pedido: pedido,
                fecha: timestamp
            };

            // Simulación de almacenamiento local (no persistente)
            let registros = JSON.parse(localStorage.getItem('entrega')) || [];
            registros.push(registro);
            localStorage.setItem('entrega', JSON.stringify(registros));

            document.getElementById('formEntrega').reset();
            document.getElementById('mensajeEntrega').innerText = 'El registro se realizó exitosamente.';
            mostrarRegistros();
            setTimeout(() => {
                document.getElementById('mensajeEntrega').innerText = '';
                document.getElementById('registroEntrega').classList.remove('active');
            }, 3000);
        }

        function registrarFinalizado() {
            const nombre = document.getElementById('nombreFinalizado').value;
            const pedido = document.getElementById('pedidoFinalizado').value;
            const estatus = document.getElementById('estatus').value;
            const observaciones = document.getElementById('observaciones').value;
            const timestamp = new Date().toLocaleString();

            const registro = {
                nombre: nombre,
                pedido: pedido,
                fecha: timestamp,
                estatus: estatus,
                observaciones: observaciones
            };

            // Simulación de almacenamiento local (no persistente)
            let registros = JSON.parse(localStorage.getItem('finalizado')) || [];
            registros.push(registro);
            localStorage.setItem('finalizado', JSON.stringify(registros));

            document.getElementById('formFinalizado').reset();
            document.getElementById('mensajeFinalizado').innerText = 'El registro se realizó exitosamente.';
            mostrarRegistros();
            setTimeout(() => {
                document.getElementById('mensajeFinalizado').innerText = '';
                document.getElementById('registroFinalizado').classList.remove('active');
            }, 3000);
        }

        function cancelarRegistro(opcion) {
            if (opcion === 'entrega') {
                document.getElementById('registroEntrega').classList.remove('active');
            } else if (opcion === 'finalizado') {
                document.getElementById('registroFinalizado').classList.remove('active');
            }
        }

        function mostrarRegistros() {
            let entregaRegistros = JSON.parse(localStorage.getItem('entrega')) || [];
            let finalizadoRegistros = JSON.parse(localStorage.getItem('finalizado')) || [];

            let listaHTML = '';
            entregaRegistros.forEach(registro => {
                listaHTML += `<div class="registro entrega">
                                <p><strong>Nombre:</strong> ${registro.nombre}</p>
                                <p><strong>Número de Pedido:</strong> ${registro.pedido}</p>
                                <p><strong>Fecha:</strong> ${registro.fecha}</p>
                             </div>`;
            });

            finalizadoRegistros.forEach(registro => {
                listaHTML += `<div class="registro finalizado">
                                <p><strong>Nombre:</strong> ${registro.nombre}</p>
                                <p><strong>Número de Pedido:</strong> ${registro.pedido}</p>
                                <p><strong>Fecha:</strong> ${registro.fecha}</p>
                                <p><strong>Estatus:</strong> ${registro.estatus}</p>
                                <p><strong>Observaciones:</strong> ${registro.observaciones}</p>
                             </div>`;
            });

            document.getElementById('listaRegistros').innerHTML = listaHTML;
            document.getElementById('registros').classList.add('active');
        }

        function actualizarReloj() {
            const now = new Date();
            const horas = String(now.getHours()).padStart(2, '0');
            const minutos = String(now.getMinutes()).padStart(2, '0');
            const segundos = String(now.getSeconds()).padStart(2, '0');
            const tiempo = `${horas}:${minutos}:${segundos}`;
            document.getElementById('reloj').innerText = tiempo;
        }

        function exportarRegistros() {
            let entregaRegistros = JSON.parse(localStorage.getItem('entrega')) || [];
            let finalizadoRegistros = JSON.parse(localStorage.getItem('finalizado')) || [];

            const fechaInicio = new Date(document.getElementById('fechaInicio').value);
            const fechaFin = new Date(document.getElementById('fechaFin').value);

            entregaRegistros = entregaRegistros.filter(registro => {
                const fechaRegistro = new Date(registro.fecha);
                return fechaRegistro >= fechaInicio && fechaRegistro <= fechaFin;
            });

            finalizadoRegistros = finalizadoRegistros.filter(registro => {
                const fechaRegistro = new Date(registro.fecha);
                return fechaRegistro >= fechaInicio && fechaRegistro <= fechaFin;
            });

            let entregaData = entregaRegistros.map(registro => ({
                Nombre: registro.nombre,
                'Número de Pedido': registro.pedido,
                Fecha: registro.fecha
            }));

            let finalizadoData = finalizadoRegistros.map(registro => ({
                Nombre: registro.nombre,
                'Número de Pedido': registro.pedido,
                Fecha: registro.fecha,
                Estatus: registro.estatus,
                Observaciones: registro.observaciones
            }));

            let wb = XLSX.utils.book_new();

            let wsEntrega = XLSX.utils.json_to_sheet(entregaData);
            XLSX.utils.book_append_sheet(wb, wsEntrega, 'Registros de Entrega');

            let wsFinalizado = XLSX.utils.json_to_sheet(finalizadoData);
            XLSX.utils.book_append_sheet(wb, wsFinalizado, 'Registros de Finalizado');

            XLSX.writeFile(wb, 'registros.xlsx');
        }

        // Mostrar registros al cargar la página
        window.onload = function() {
            mostrarRegistros();
            setInterval(actualizarReloj, 1000);
        };
    </script>
</body>
</html>
